# cc_trait
## R code for
Accounting for non-linear responses to traits improves range shift predictions
by Anthony F. Cannistra and Lauren B. Buckley

## Data
Data in the data folder for running the analyses are from the following publications. Please refer to the Cannistra and Buckley manuscript for additional details. Data correspondign to the first two publications were provided by authors Amy Angert and Malin Pinksy.

Angert, A. L., L. G. Crozier, L. J. Rissler, S. E. Gilman, J. J. Tewksbury, and A. J. Chunco. 2011. Do species’ traits predict recent shifts at expanding range edges? Ecology Letters 14:677–689.

Pinsky, M. L., B. Worm, M. J. Fogarty, J. L. Sarmiento, and S. A. Levin. 2013. Marine Taxa Track Local Climate Velocities. Science 341:1239–1242.

Hällfors, M. H., J. Pöyry, J. Heliölä, I. Kohonen, M. Kuussaari, R. Leinonen, R. Schmucki, P. Sihvonen, and M. Saastamoinen. 2021. Combining range and phenology shifts offers a winning strategy for boreal Lepidoptera. Ecology Letters 24:1619–1632.

## Manuscript abstract
Accurately predicting species’ range shifts in response to environmental change is paramount for understanding ecological processes and global change. In synthetic analyses, traits emerge as significant but weak predictors of species’ range shifts across recent climate change. These studies assume linear responses to traits, while detailed empirical work often reveals trait responses that are unimodal and contain thresholds or other nonlinearities. We hypothesize that the use of linear modeling approaches fails to capture these nonlinearities and therefore may be under-powering traits to predict range shifts. We evaluate the predictive performance of approaches that can capture nonlinear relationships (ridge-regularized linear regression, support vector regression with linear and non-linear kernels, and random forests). We apply our models using six multi-decadal range shift datasets for plants, moths, marine fish, birds, and small mammals. We show that nonlinear approaches can perform substantially better than least-squares linear modeling in reproducing historical range shifts. Consistent with expectations, we identify dispersal and climatic niche traits as primary determinants of distribution shifts. Traits identified as important predictors and the direction of trait effects are generally consistent across models but there are notable exceptions. Among important predictors, there are more consistent responses to climatic niches than dispersal ability.  Absent or modest improvements in predictability when accounting for non-linearities and interactions and the overall low amount of variance accounted for by trait predictors suggests limits to trait-based statistical predictive frameworks. 
